# Intro scene

Network data arises frequently in applications and the simplest networks are undirected, unweighted graphs.
In order to perform TDA on such a graph, we typically assign a higher-dimensional topological space.
A common construction is the clique complex in which we fill in every k-clique with a k-simplex.
<!--From this simplicial complex, we can derive a chain complex and subsequently compute homology groups.-->

But network data often arises as a directed graph.
<!--Common examples include brain connectomes, in which some synapses pass signals exclusively in one direction, or vascular networks, in which blood flow has a net direction in each vessel.-->
In this setting, a natural analogue to the clique complex is the directed flag complex. 
A directed k-clique is a (k+1)-tuple of vertices such that all pairs of vertices in the tuple are connected by an edge, in the direction specified by the tuple.
Note, the collection of directed cliques is closed under arbitrary vertex removal.
As such, the collection of all directed cliques forms an ordered simplicial complex.
We can represent this by a chain complex and hence we can compute its homology.

# Defining path homology

This is a useful construction in settings where directed cliques are already distinguished motifs.
<!--For example, in a connectome, a large clique represents a reliable connection between its two end neurons, in the sense that the connection is robust to multiple edge removals.-->
In other settings, the directed flag complex might not be as relevant.
An alternative construction, defined by Grigor'yan et al, is path homology -- this construction is built on directed paths within the digraph and is not defined via a simplicial complex.

## Underlying groups

Instead, given a digraph, we say an elementary path is any sequence of vertices.
Then an allowed path is a sequence of vertices such that subsequent vertices are joined by directed edges in the graph.
In this example, `abda` is allowed but `abdc` is not allowed.
We use the collections of all such paths to freely generate two different ℤ-modules, `Λ_p` and `A_p`.
We also define a boundary map, between the `Λ_p`, using the usual formula.

## Omegas and chain complex

This gives a chain complex between the ℤ-modules of elementary paths but not between the modules of allowed paths.
Given an allowed 2-path, its boundary might not be a sum of allowed 1-paths.
That is, we can't traverse back up this inclusion map.
For example, in this digraph, the boundary of `abd` contains the element `ad` which is not an edge in the digraph.

To resolve this issue we define `Ω_p` to be the elements of `A_p` whose boundaries can traverse back up the inclusion map.
It is quick to check that the boundary of an element in `Ω_p` not only includes into `A_{p-1}` but also `Ω_{p-1}`.
So, we get a new chain complex, which now incorporates information about the directed paths in the digraph.
In our previous examples `abd` is still not an element of `Ω_2` but `abd - acd` is an element, because the missing edges in the boundary are cancelled out.
The homology of this chain complex is called the non-regular path homology.

Note that the chain groups `Ω_p` are not necessarily freely generated by a subset of the allowed p-paths, so finding a basis is often non-trivial.
However, we do have good descriptions of the bottom three chain groups.
`Ω_0` is freely generated by all the vertices.
`Ω_1` is freely generated by all the edges.
`Ω_2` has three types of generators - eyeglasses, directed triangles and long squares (as we saw in the example)

## Random graphs

Our aim is to understand how path homology Betti 1 usually behaves subject to a simple, Erdos-Renyi null model `G(n, p)`
in which the number of nodes is fixed at `n` and each directed edge appears independently with probability `p`.
Our first question is when should we expect Betti 1 to be zero, and when should we expect it to be non-zero?

## Experiments

Here, we compute empirical distributions of Betti 1 and plot, in colour, the probability that Betti 1 is zero, against the log of n and p on the two axes.
We see two clear boundaries: when p is too low Betti 1 is zero almost surely and likewise when p is too high.
In the middle there is a goldilocks region when Betti 1 is almost surely positive.
Intuitively, as we cross the lower boundary, it becomes likely that the kernel is non-empty.
When we cross the second boundary the kernel is still non-empty but they are sufficiently many 2-chains that all cycles are homologous to zero.
In order to determine the gradients of these boundaries, we are going to investigate straight line trajectories through this diagram.

## Lower Densities

As with many traditional homologies, the kernel of the boundary operator has a basis of undirected cycles and hence the presence of such a cycle is a necessary for positive Betti 1.
By an easy union bound we can bound the probability of there existing an undirected cycle.
When `p=n^α` with `α<-1` this bound tends to 0.
<!--So as we follow such trajectories it becomes highly likely that Betti 1 is zero.-->

## High Densities

The story at high densities is slightly more complicated.
One intuition is that, at high densities, any longer cycles are homologous to much smaller cycles, which themselves are likely to be homologous to zero.
Consider a vertex separate from the cycle with the following connected edges.
It is quick to check that this subgraph has Betti 1 = 0 and hence the outer red path is homologous to the slightly shorter, green path.
We call such a vertex a directed centre for the red path.
Notice that the event that `κ` is a directed centre is independent from the event that `κ` prime is a centre, since they depend on disjoint edge sets.

This is a useful property that lets us get our hands on a decent bound on the probability that there is a path __without__ a directed centre.
The exponential term arises from a product over all possible directed centres.
The power of `p` is 3 since a directed centre requires three connecting edges and this is multiplied by the number of possible directed centres, `n-4`.

Directed centres let us reduce long cycles into smaller cycles.
Then all that remains is to show that short cycles are trivial with high probability.
One way in which a 3-cycle could be trivial is if there is a centre vertex with connecting edges all pointing outwards.
A quick union bound shows that the probability of there being a 3-cycle without such a vertex tends to 0 under the same assumption on `p`.

## Boundary gradient implications

